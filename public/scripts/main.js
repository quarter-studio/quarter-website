'use strict';(function(){var a=document.querySelector(".shader");window.animation=((e,c)=>{var a=e.getContext("webgl"),d=twgl.createBufferInfoFromArrays(a,c.buffer);e=c.fs;for(var b in c.options)e=e.replace("#endif",`#endif\nuniform float u_${b};\n`);var f={...c.textures};for(b in f){var k=f[b]={...f[b]};k.mag&&(k.mag=a[k.mag])}f=twgl.createTextures(a,f);var l=twgl.createProgramInfo(a,[c.vs,e]);a.useProgram(l.program);twgl.setBuffersAndAttributes(a,l,d);var g={u_time:0,u_mouse:[0,0]},h={_uniforms:g,
enabled:!0,options:Object.keys(c.options),render:()=>{h.enabled&&(twgl.setUniforms(l,g),twgl.drawBufferInfo(a,d))},get:a=>g[`u_${a}`],set:(a,e)=>{g[`u_${a}`]=e}};for(b in c.textures)h.set(b,f[b]);for(b in c.options)h.set(b,c.options[b]);return h})(a,{fs:"\n#ifdef GL_ES\nprecision mediump float;\n#endif\nuniform vec2 u_resolution;\nuniform vec2 u_mouse;\nuniform float u_time;\nuniform sampler2D u_texture;\nuniform sampler2D u_ashima1;\nuniform sampler2D u_ashima2;\nfloat random(vec2 st) {\n  float a = 12.9898;\n  float b = 78.233;\n  float c = 43758.5453;\n  float dt= dot(st.xy ,vec2(a,b));\n  float sn= mod(dt,3.14);\n  return fract(sin(sn) * c);\n}\nfloat whiteNoise(in vec2 p){\n  vec2 tv = p * vec2(u_resolution.x/256., u_resolution.y/256.);  return (texture2D(u_texture, tv).r);\n}\nfloat snoise(in vec2 p){\n  vec2 tv = p * vec2(u_resolution.x/2048., u_resolution.y/2048.);  vec4 tex = texture2D(u_ashima1, tv);\n  return tex.r;\n}\nfloat snoise2(in vec2 p){\n  vec2 tv = p * vec2(u_resolution.x/2048., u_resolution.y/2048.);  vec4 tex = texture2D(u_ashima2, tv);\n  return tex.r;\n}\nconst float STEPS = 4.;\nconst float LINE_WIDTH = 0.002;\nconst float CUTOFF = 0.5;\nfloat posX = u_mouse.x * 0.1;\nfloat posY = u_mouse.y * 0.1;\nvec2 mouseUV = u_mouse / u_resolution;\nvec3 hsv2rgb(vec3 c){\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nmat2 rotate2d(float a){\n  return mat2(\n      cos(a), -sin(a),\n      sin(a), cos(a)\n  );\n}\nfloat getNoise(vec2 uv, float t){\n  const float SCALEX = 1.;\n  const float SCALEY = 1.;\n  float noise = snoise( rotate2d(sin(t*0.1) + posY * 2.) * vec2(uv.x * SCALEX + posX + t, uv.y * SCALEY + posY + t));\n  return noise;\n}\nfloat getDepth(float n){\n  float d = (n - CUTOFF) / (1. - CUTOFF);\n  d = floor(d*STEPS)/STEPS;\n  return d;\n}\nvoid main(){\n  float t = u_time * 0.01;\n  vec2 uv = gl_FragCoord.xy / u_resolution;\n  vec3 col = vec3(0);\n  float noise = getNoise(uv, t);\n  float d = getDepth(noise);\n  float h = 0.5;  float s = 0.;\n  float v = 0.;\n  float WIDEN = 1. + (sin(t)+1.)/2. * 1.5;\n  const int STEPS = 16;\n  for (int j=0; j<STEPS; j++){\n    vec2 dOffset = vec2(\n      getDepth(getNoise(uv + vec2(0, LINE_WIDTH) * WIDEN * pow(float(j), 1.25), t)),\n      getDepth(getNoise(uv + vec2(0, -LINE_WIDTH) * WIDEN * pow(float(j), 1.25), t))\n    );\n    if (d != dOffset.x || d != dOffset.y){\n      h = 0.;      s = 0.;\n      v += .0625 * floor( whiteNoise(uv*2.) + 0.2 * float(STEPS)/float(j+1));      if (d != dOffset.x){\n        v *= 0.75;\n      }\n    }\n  }\n  col = hsv2rgb(vec3(h,s,v));\n  col *= 0.2 + (gl_FragCoord.y/u_resolution.y) * 0.8;\n  gl_FragColor = vec4(col, 1.0);\n}",
vs:"attribute vec4 position;\nvoid main() {\n  gl_Position = position;\n}",buffer:{position:[-1,-1,0,1,-1,0,-1,1,0,-1,1,0,1,-1,0,1,1,0]},textures:{noise:{mag:"NEAREST",src:"/images/noise.png"},ashima1:{src:"/images/ashima1.png"},ashima2:{src:"/images/ashima2.png"}},options:{blur_x:.5,blur_y:.55,dither:.3,size:.3,edge:.425,gamma:.3,viscosity:.15}});var d=()=>{twgl.resizeCanvasToDisplaySize(a);a.getContext("webgl").viewport(0,0,a.width,a.height);animation.set("resolution",[a.width,a.height])};window.addEventListener("resize",
d);d();d=()=>{animation.enabled=window.pageYOffset<1.15*window.innerHeight};window.addEventListener("scroll",d);d();var m=a=>{animation.set("time",.001*a);animation.render();requestAnimationFrame(m)};m(0);var n=a=>{192===a.keyCode&&(a=document.createElement("script"),a.src="/scripts/editor.js",a.onload=void 0,document.body.appendChild(a),window.removeEventListener("keydown",n))};window.addEventListener("keydown",n)})();
//# sourceMappingURL=main.js.map
